<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
	<script src="../JS수업/JS/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="../JS수업/JS/rolling.js"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.3/css/all.css" integrity="sha384-SZXxX4whJ79/gErwcOYf+zWLeJdY/qpuqC4cAa9rOGUstPomtqpuNWT9wdPEn2fk" crossorigin="anonymous">
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css"/>
    
    <style>
        *{
            margin: 0;
            padding: 0;
            list-style: none;
            text-decoration: none;
        }
        
        .img-container{
            min-width: 1400px;
            height: 300px;
            background: yellow;
        }
        .inner-container{
            min-width: 900px;
            display: flex;
        }
        .inner-container .left-container{
            width: calc(75% - 20px);
            min-width: 900px;
        }
        .left-container .inner-box{
            max-width: 900px;
            margin: 0 auto;
        }
        .left-container .top-container{
            padding: 10px;
            border-bottom: 1px solid rgba(160, 160, 160, 0.3);
        }
        .top-container .shop-head .fa-star{
            color: rgb(255, 165, 0);
            font-size: 50px;
        }
        .top-container .title{
            font-size: 30px;
            font-weight: bold;
            margin-bottom: 20px;
            display: flex;
        }
        .top-container .title .shop-box{
            width: 70%;
            font-size: 30px;
        }
        .top-container .title .btn-box{
            width: 30%;
            max-height: 110px;
            color: #404040;
        }
        .top-container .title .review-btn,
        .top-container .title .favorites-btn{
            text-align: center;
            float: right;
            margin-right: 10px;
        }
        .top-container .title .review-btn:hover,
        .top-container .title .favorites-btn:hover{
            color: rgb(255, 165, 0);
            cursor: pointer;
        }
        .top-container .title .btn-box i{
            font-size: 30px;
        }
        .top-container .review-text,
        .top-container .favorites-text{
            font-size: 20px;
        }
        .top-container .title .rt_score{
            color: rgb(255, 165, 0);
        }
        .top-container .inf-box{
            color: rgb(124, 124, 124);
        }
        .top-container .inf-box span{
            margin-right: 20px;
        }
        .top-container .inf-box i{
            margin-right: 5px;
        }
        .left-container .middle-container{
            position: relative;
            border-bottom: 1px solid rgba(160, 160, 160, 0.3);
        }
        .middle-container .detail-box{
            box-sizing: border-box;
            padding: 10px;
        }
        .main-container .shop-inf{
            display: flex;
        }
        .main-container .shop-inf .inf-title{
            width: 10%;
        }
        .main-container .shop-inf .inf-content{
            width: 85%;
        }
        .middle-container .inf-content li{
            overflow: hidden;
            text-overflow: ellipsis;
            word-wrap: break-word;
            display: -webkit-box;
            -webkit-line-clamp: 1;
            -webkit-box-orient: vertical;
        }
        .middle-container .detail-box li{
            color: rgb(112, 112, 112);
            margin-bottom: 10px;
        }
        .middle-container .detail-box .btn-box{
            position:absolute;
            right: 5px;
            bottom: 5px;
        }

        /* 하단 리뷰 */
        .left-container .bottom-container{
            padding: 10px;
        }
        .bottom-container .review-container{
            background: wheat;
            position: relative;
            min-height: 150px;
            border-bottom: 1px solid rgba(160, 160, 160, 0.3);
            padding-bottom: 30px;
        }
        .review-container .review-inner{
            display: flex;
        }
        .review-container .user-box{
            width: 150px;
            padding: 10px;
        }
        .review-container .user-box .img-box{
            width: 130px;
            height: 130px;
            padding: 20px;
        }
        .review-container .user-box .img-box img{
            width: 100%;
            height: 100%;
            border-radius: 100%;
        }
        .review-container .user-box .user-nickname{
            text-overflow: ellipsis;
            word-wrap: break-word;
            -webkit-line-clamp: 2;
            text-align: center;
            margin-bottom: 10px;
            color: rgb(112, 112, 112);
        }
        .review-container .user-box .user-inf{
            display: flex;
            font-size: 15px;
            color: rgb(112, 112, 112);
            text-align: center;
        }
        .review-container .user-box .user-inf .review-num,
        .review-container .user-box .user-inf .recommend-num{
            width: 50%;
        }
        .review-container .review-box{
            background: rgb(195, 226, 18);
            width: 600px;
            padding: 5px;
        }
        .review-box .update{
            color: rgb(112, 112, 112);
        }
        .review-box .content{
            width: 100%;
            
            
        }
        .review-box .content{
            white-space: pre-line;
        }
        .review-container .side-box{
            background: rgb(52, 224, 124);
            width: 130px;
        }
        .side-box .sc-box{
            background: rgba(168, 163, 163, 0.589);
        }
        .side-box .detail-btn{
            font-size: 15px;
            color: #404040;
            cursor: pointer;
        }
        .side-box .sc-detail{
            width: 200px;
            background-color: aqua;
            display: none;
        }
        .bottom-container .report-box,
        .bottom-container .recommend-box{
            font-size: 50px;
            width: 60px;
            text-align: center;
        }
        .bottom-container .report-box:hover,
        .bottom-container .report-box:hover a,
        .bottom-container .recommend-box:hover,
        .bottom-container .recommend-box:hover a{
            color: rgb(255, 165, 0);
        }
        .bottom-container .report-box div,
        .bottom-container .recommend-box div{
            font-size: 20px;
        }
        .right-container{
            width: 25%;
        }
        .right-container .map{
            width: 500px;
            height: 500px;
            background-color: lime;
        }
        .after::after{
            display: block;
            clear: both;
            content: '';
        }
    </style>
</head>
<body>
    <div class="img-container">

    </div>
    <div class="main-container">
        <div class="inner-container">
            <div class="left-container">
                <div class="inner-box">
                    <div class="top-container">
                        <div class="title">
                            <div class="shop-box">
                                <span class="rt_name">마님은 왜 돌쇠에게만 술을 주시나</span> 
                                <span class="rt_score">4.5</span>
                            </div>
                            <div class="btn-box after">
                                <form method="GET" action="<%=request.getContextPath()%>/review/register">
                                    <input type="hidden" name="num" value="${rt.rt_num}">
                                    <div class="favorites-btn">
                                        <i class="far fa-star"></i>
                                        <div class="favorites-text">즐겨찾기</div>
                                    </div>
                                    <div class="review-btn">
                                        <i class="fas fa-pen"></i>
                                        <div class="review-text">리뷰쓰기</div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <div class="inf-box">
                            <span id="views"><i class="far fa-eye"></i>조회수</span>
                            <span id="reviewNum"><i class="fas fa-pen"></i>리뷰수</span>
                            <span id="favoritesNum"><i class="fas fa-star"></i>즐겨찾기수</span>
                        </div>
                    </div>
                    <div class="middle-container">
                        <div class="detail-box">
                            <div class="shop-inf">
                                <div class="inf-title">
                                    <ul>
                                        <li>주소</li>
                                        <li>전화번호</li>
                                        <li>음식종류</li>
                                        <li>영업시간</li>
                                    </ul>
                                </div>
                                <div class="inf-content">
                                    <ul>
                                        <li>${rt.rt_address}${rt.rt_address}${rt.rt_address}${rt.rt_address}${rt.rt_address}${rt.rt_address}${rt.rt_address}${rt.rt_address}</li>
                                        <li>${rt.rt_phoneNum}</li>
                                        <li>${rt.rt_type}</li>
                                        <li>${rt.rt_openTime}</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="btn-box">
                                <c:if test="${user != null && (user.me_id == rt.rt_me_id || user.me_authority == 'ADMIN' || user.me_authority == 'SUPER ADMIN')}">
                                    <a href="<%=request.getContextPath()%>/restaurant/modify?num=${rt.rt_num}" style="text-decoration: none">
                                        <button class="btn btn-outline-success">수정</button>
                                    </a>
                                    <a href="<%=request.getContextPath()%>/restaurant/delete?num=${rt.rt_num}" style="text-decoration: none">
                                        <button class="btn btn-outline-danger">삭제</button>
                                    </a>
                                </c:if>
                            </div>
                        </div>
                    </div>
                    <div class="bottom-container">
                        <div class="review-container">
                            <c:forEach items="${reviews}" var="review">
                                <div class="review-inner">
                                    <div class="user-box">
                                        <div class="img-box">
                                            <img src="../JS수업/img/cat.jfif">
                                        </div>
                                        <div class="user-nickname">${review.re_me_nickname}</div>
                                        <div class="user-inf">
                                            <div class="review-num">
                                                <i class="fas fa-pen"></i>
                                                <div>9999+</div>
                                            </div>
                                            <div class="recommend-num">
                                                <i class="fas fa-thumbs-up"></i>
                                                <div>9999+</div>
                                            </div>                                            
                                        </div>
                                    </div>
                                    <div class="review-box">
                                        <div class="update">${review.re_upDateStr}</div>
                                        <pre class="content">${review.re_content}침략자 다대다의
                                             게임 플레이가 가능한 게임으로, 학교 대항전이나 반 대항전
                                             과 같은 여러 명이 동시에 플레이가 가능하다. 클랜을 통해 클랜 대전이 가능하며, 해당 클랜전을 통해 순위를 업로드할 수 있다. 
                                             과거 여러 명이 함께 판을 뒤집는 형태의 타자게임으로 카드의 단어를 입력하여, 우리팀이 속한 색상의 판 갯수가 많으면 이기는 형태의 게임이다. 같은 색상의 판을 입력하여, 뒤집었을 때는 판의 단어 글자가 바뀌어, 방어를 할 수 있다. 일정 시간 이후 이벤트 타임을 통해 장문을 빠르게 입력하여, 보너스 점수 획득이 가능하다.
                                        </pre>
                                        <div class="image-box">
                                            <img src="../JS수업/img/cat.jfif" alt="">
                                        </div>
                                    </div>
                                    <div class="side-box">
                                        <div class="sc-box">
                                            <div class="sc-total">
                                                <div>${review.re_totalSc}</div>
                                                <div class="detail-btn">상세보기<i class="fas fa-caret-down"></i></div>
                                            </div>
                                            <div class="sc-detail">
                                                <div>서비스 ★★★★★</div>
                                                <div>분위기 ${review.re_mood}</div>
                                                <div>청결함 ${review.re_clean}</div>
                                                <div>음식맛 ${review.re_tasty}</div>
                                                <div>음식량 ${review.re_quantity}</div>
                                            </div>
                                        </div>
                                        <c:choose>
                                            <c:when test="${user.me_id != rt.rt_me_id}">
                                                <div class="btn-box">
                                                    <div class="recommend-box">
                                                        <a href="#">
                                                            <i class="far fa-thumbs-up"></i>
                                                        </a>
                                                        <div>맛잘알</div>
                                                    </div>
                                                    <div class="report-box">
                                                        <a href="#">
                                                            <i class="fas fa-bullhorn"></i>
                                                        </a>
                                                        <div>신고</div>
                                                    </div>
                                                </div>
                                            </c:when>
                                            <!-- <c:otherwise>
                                                <div class="btn-box">
                                                    <a href="<%= request.getContextPath() %>/review/modify?num=${review.re_num}">
                                                        <button class="mod-btn btn btn-outline-success">수정</button>
                                                    </a>
                                                    <button class="del-btn btn btn-outline-danger">삭제</button>
                                                    <input class="re_num" type="hidden" value="${review.re_num}">
                                                </div>
                                            </c:otherwise> -->
                                        </c:choose>
                                    </div>
                                </div>
                            </c:forEach>
                        </div>
                    </div>
                </div>
            </div>
            <div class="right-container">
                <div class="map">

                </div>
            </div>
        </div>
    </div>
	<script type="text/javascript">
        $(function(){
            var contextPath = '<%=request.getContextPath()%>';
            $(document).on('click', '.del-btn', function(){
                var re_num = $(this).siblings('.re_num').val();
                var data = {re_num : re_num}
                $.ajax({
                    type : 'post',
                    url  : contextPath + '/review/delete',
                    data : data,
                    success : function(res){
                        if (res == 'OK') {
                            alert('리뷰삭제 성공');
                            $('#review-box').load("/matboda/restaurant/main #review-box");
                        }else{
                            alert('리뷰삭제 실패');
                        }
                    }
                })
            })
            $(document).on('click', '.detail-btn', function(){
                $('.sc-detail').toggle();
            })
        })
	</script>
</body>
</html>